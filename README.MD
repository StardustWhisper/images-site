# 图片管理系统

## 项目简介

这是一个基于Node.js和Express框架开发的图片管理系统。该系统允许用户上传、查看、搜索和删除图片,并自动生成缩略图。它使用Docker进行容器化部署,便于在不同环境中快速搭建和运行。

## 主要功能

1. 图片上传：支持多文件上传,自动创建文件夹和缩略图。
2. 图片浏览：分页显示图片列表,支持缩略图预览。
3. 图片搜索：根据文件名搜索图片。
4. 图片删除：删除指定图片及其缩略图。
5. 自适应缩略图：根据原图比例生成最大300px的缩略图。
6. 健康检查：提供健康检查接口。

## 技术栈

- 后端：Node.js, Express
- 图片处理：Sharp
- 文件上传：Multer
- 容器化：Docker, Docker Compose

## 项目结构

```bash
project-root/
│
├── public/
│ ├── images/ # 存储上传的图片和缩略图
│ └── index.html # 前端页面
│
├── server.js # 主服务器文件
├── Dockerfile # Docker构建文件
├── docker-compose.yml # Docker Compose配置文件
└── package.json # 项目依赖配置
```

## 关键代码解读

1. 图片上传和缩略图生成
   - 使用Multer中间件处理文件上传
   - 使用Sharp库生成缩略图,保持原图比例

2. 图片列表获取
   - 递归遍历图片目录
   - 支持分页和搜索功能
   - 返回图片路径、缩略图路径和分辨率信息

3. 图片删除
   - 通过路径参数定位并删除指定图片

4. 环境配置
   - 使用环境变量配置端口、基础URL和复制URL
   - 支持通过Docker环境变量覆盖默认配置

## 部署说明

1. 确保安装了Docker和Docker Compose
2. 克隆项目到本地
3. 在项目根目录运行:
   ```
   docker-compose up --build
   ```
4. 访问 `http://localhost:3000` 即可使用系统

## 注意事项

- 生产环境部署时,请修改`docker-compose.yml`中的`COPY_URL`为实际的公网域名
- 图片文件存储在`./public/images`目录,请确保该目录有足够的存储空间
- 系统默认使用3000端口,如需更改,请同时修改`Dockerfile`和`docker-compose.yml`

## 未来改进方向

1. 添加用户认证和授权系统
2. 实现图片分类和标签功能
3. 优化大量图片时的加载性能
4. 添加图片编辑功能(如裁剪、旋转等)
5. 实现图片批量操作功能
